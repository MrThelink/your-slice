<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device                           
    <title>Your Slice - Home</title>
    <!-- Add favicon to fix 404 error -->
    <link rel="icon" type="image/png" sizes="32x32" data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==" />
    <link rel="stylesheet" href="shared/shared.css">
    <link rel="stylesheet" href="home/index.css">
    <link rel="stylesheet" href="home/hsl-styles.css">
    <link rel="stylesheet" href="shared/language-switcher.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    
    <!-- Load Leaflet first -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    
    <!-- Then load our scripts -->
    <script src="auth/auth.js" defer></script>
    <script src="shared/shared.js" defer></script>
    <script src="shared/language-switcher.js" defer></script>
    <script src="home/hsl-integration.js" defer></script>
    <script src="home/index.js" defer></script>
    <script>
        // Add polyline decoding function to global scope
        window.decodePolyline = function(encoded) {
            const poly = [];
            let index = 0, len = encoded.length;
            let lat = 0, lng = 0;
            
            while (index < len) {
                let b, shift = 0, result = 0;
                do {
                    b = encoded.charCodeAt(index++) - 63;
                    result |= (b & 0x1f) << shift;
                    shift += 5;
                } while (b >= 0x20);
                const dlat = ((result & 1) ? ~(result >> 1) : (result >> 1));
                lat += dlat;
                
                shift = 0;
                result = 0;
                do {
                    b = encoded.charCodeAt(index++) - 63;
                    result |= (b & 0x1f) << shift;
                    shift += 5;
                } while (b >= 0x20);
                const dlng = ((result & 1) ? ~(result >> 1) : (result >> 1));
                lng += dlng;
                
                poly.push([lat * 1e-5, lng * 1e-5]);
            }
            return poly;
        };
    </script>

    <!-- Smooth Scroll -->
    <style>
        html {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div id="header-placeholder"></div>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="container">
            <h2 data-i18n="hero-title">Create Your Perfect Pizza Slice</h2>
            <p data-i18n="hero-subtitle">Customize every aspect of your pizza slice - from dough to toppings - baked fresh right before your eyes</p>
            <button class="btn btn-primary btn-large" id="buildNowBtn" data-i18n="hero-btn">Build Your Slice Now</button>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about-section">
        <div class="container">
            <div class="section-title">
                <h2 data-i18n="about-title">About Your Slice</h2>
                <p data-i18n="about-subtitle">Discover what makes us special</p>
            </div>
            <div class="about-content">
                <div class="about-text">
                    <h3 data-i18n="about-heading">Fresh, Customized Pizza Slices</h3>
                    <p>At Your Slice, we believe everyone deserves their perfect pizza. That's why we've created a unique experience where you can customize every aspect of your pizza slice, baked fresh right before your eyes.</p>
                    <p>Whether you're craving a classic Margherita or an adventurous creation with unique toppings, we've got you covered. Our daily lunch specials offer great value, and our build-your-own system lets you create exactly what you want.</p>
                    <div class="features-grid">
                        <div class="feature">
                            <span class="feature-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
                                </svg>
                            </span>
                            <h4>Custom Creations</h4>
                            <p>Build your perfect slice with our step-by-step builder</p>
                        </div>
                        <div class="feature">
                            <span class="feature-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67M11.71 19c-1.23 0-2.63-2.26-2.63-5.92 0-.08 0-.13.02-.2h5.24c.02.07.03.12.02.2 0 3.66-1.6 5.92-2.65 5.92"/>
                                </svg>
                            </span>
                            <h4>Freshly Baked</h4>
                            <p>Every slice is baked fresh when you order</p>
                        </div>
                        <div class="feature">
                            <span class="feature-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
                                </svg>
                            </span>
                            <h4>Vegan Options</h4>
                        <p>Plenty of plant-based choices available</p>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">üö¥</span>
                        <h4>Fast Delivery</h4>
                        <p>Quick delivery right to your doorstep</p>
                    </div>
                </div>
            </div>
            <div class="about-image">
                <img src="https://images.unsplash.com/photo-1513104890138-7c749659a591?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Our Pizza">
            </div>
        </div>
    </section>

    <!-- Today's Menu Section -->
    <section id="todays-menu" class="todays-menu-section">
        <div class="container">
            <div class="todays-menu-header">
                <h3 data-i18n="todays-menu">Today's Special Menu</h3>
                <p data-i18n="menu-subtitle">Fresh offerings prepared just for you</p>
            </div>
            <div id="todays-menu-container">
                <!-- Menu items will be loaded here dynamically -->
            </div>
        </div>
    </section>

    <!-- Location Section -->
    <section id="location" class="location-section">
        <div class="container">
            <div class="section-title">
                <h2 data-i18n="visit-us">Visit Us</h2>
                <p data-i18n="location-subtitle">Find our location and get directions</p>
            </div>
            <div class="location-content">
                <div class="location-info">
                    <h3 data-i18n="our-restaurant">Our Restaurant</h3>
                    <div class="contact-details">
                        <div class="contact-item">
                            <strong>Address:</strong>
                            <p>Pizza Street 123, 00100 Helsinki, Finland</p>
                        </div>
                        <div class="contact-item">
                            <strong>Phone:</strong>
                            <p>+358 12 345 6789</p>
                        </div>
                        <div class="contact-item">
                            <strong>Email:</strong>
                            <p>hello@yourslice.fi</p>
                        </div>
                        <div class="contact-item">
                            <strong>Opening Hours:</strong>
                            <p>Mon-Thu: 10:30 - 22:00</p>
                            <p>Fri-Sat: 10:30 - 00:00</p>
                            <p>Sun: 12:00 - 22:00</p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="getDirections()">Get Directions</button>
                </div>
                <div class="map-container">
                    <div id="map"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- HSL Public Transport Information Section -->
    <section id="hsl-section" class="hsl-section">
        <div class="container">
            <div class="hsl-section-title">
                <h3><svg class="hsl-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"></path><path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"></path></svg> <span data-i18n="hsl-title">Getting Here by Public Transport</span></h3>
                <p data-i18n="hsl-subtitle">Helsinki region's easy and eco-friendly transportation options</p>
            </div>

            <!-- Nearby Transit Stops -->
            <div id="hsl-nearby-stops">
                <!-- Nearby stops will be loaded dynamically -->
            </div>

            <!-- Available Routes Information -->
            <div id="hsl-routes-info">
                <!-- Route information will be loaded dynamically -->
            </div>

            <!-- Journey Planning -->
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-public-transport" onclick="window.hslIntegration && window.hslIntegration.getPublicTransportDirections()">
                    Plan Journey by Public Transport
                </button>
            </div>
            <div id="journey-plan"></div>

            <!-- HSL Info Card -->
            <div style="margin-top: 30px; background: white; padding: 20px; border-radius: 8px; border-left: 4px solid var(--primary); box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h4 style="color: var(--dark); margin-top: 0;">‚ÑπÔ∏è About HSL</h4>
                <p style="color: #666; margin: 10px 0;">
                    HSL (Helsingin Seudun Liikenne) operates buses, trams, metro, commuter trains, and ferries across the Helsinki region. 
                    With over 100 routes, it's the most convenient way to reach Your Slice from anywhere in the metropolitan area.
                </p>
                <p style="color: #666; margin: 10px 0; font-size: 0.9rem;">
                    <strong>Learn more:</strong> 
                    <a href="https://www.hsl.fi/en" target="_blank" style="color: var(--primary); text-decoration: none;">HSL Official Website</a> | 
                    <a href="https://www.hsl.fi/en/journey-planning" target="_blank" style="color: var(--primary); text-decoration: none;">Journey Planner</a> |
                    <a href="https://www.hsl.fi/en/tickets" target="_blank" style="color: var(--primary); text-decoration: none;">Tickets & Prices</a>
                </p>
            </div>
        </div>
    </section>

    <!-- Map functionality is handled by home/index.js -->
    <script>
        // Simple map test - check if Leaflet loads
        window.addEventListener('load', function() {
            console.log('Leaflet available:', typeof L !== 'undefined');
            console.log('Map element exists:', !!document.getElementById('map'));
        });
    </script>

    <!-- Cart Panel -->
    <div class="cart-panel">
        <div class="cart-header">
            <h2>Your Order</h2>
            <button class="close-cart">√ó</button>
        </div>
        <div class="cart-items">
            <div class="empty-cart">
                <div class="empty-cart-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                </div>
                <p>Your cart is empty</p>
            </div>
        </div>
        <div class="cart-summary">
            <div class="summary-row">
                <span>Subtotal:</span>
                <span class="cart-subtotal">‚Ç¨0.00</span>
            </div>
            <div class="summary-row">
                <span>Delivery fee:</span>
                <span class="delivery-fee">‚Ç¨2.50</span>
            </div>
            <div class="summary-row summary-total">
                <span>Total:</span>
                <span class="cart-total">‚Ç¨2.50</span>
            </div>
            <button class="checkout-btn">Proceed to Checkout</button>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-placeholder"></div>
</body>
</html>